# Migration `20200930085445`

This migration has been generated by kimjeongwonn at 9/30/2020, 8:54:45 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."User" (
"id" text   NOT NULL ,
"username" text   NOT NULL ,
"email" text   NOT NULL ,
"firstName" text   DEFAULT E'',
"lastName" text   DEFAULT E'',
"bio" text   DEFAULT E'',
"profileImage" text   DEFAULT E'',
"loginSecret" text   ,
"signUpAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."Post" (
"id" SERIAL,
"location" text   ,
"caption" text   ,
"userId" text   NOT NULL ,
"postAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."Comment" (
"id" SERIAL,
"text" text   NOT NULL ,
"userId" text   NOT NULL ,
"postId" integer   NOT NULL ,
"commentAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."File" (
"id" SERIAL,
"url" text   NOT NULL ,
"postId" integer   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."Room" (
"id" SERIAL,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."Message" (
"id" SERIAL,
"text" text   NOT NULL ,
"fromUserId" text   NOT NULL ,
"roomId" integer   NOT NULL ,
"timeStamp" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
PRIMARY KEY ("id")
)

CREATE TABLE "public"."_FollowRelation" (
"A" text   NOT NULL ,
"B" text   NOT NULL 
)

CREATE TABLE "public"."_LikeList" (
"A" integer   NOT NULL ,
"B" text   NOT NULL 
)

CREATE TABLE "public"."_RoomToUser" (
"A" integer   NOT NULL ,
"B" text   NOT NULL 
)

CREATE UNIQUE INDEX "User.username_unique" ON "public"."User"("username")

CREATE UNIQUE INDEX "User.email_unique" ON "public"."User"("email")

CREATE UNIQUE INDEX "_FollowRelation_AB_unique" ON "public"."_FollowRelation"("A", "B")

CREATE INDEX "_FollowRelation_B_index" ON "public"."_FollowRelation"("B")

CREATE UNIQUE INDEX "_LikeList_AB_unique" ON "public"."_LikeList"("A", "B")

CREATE INDEX "_LikeList_B_index" ON "public"."_LikeList"("B")

CREATE UNIQUE INDEX "_RoomToUser_AB_unique" ON "public"."_RoomToUser"("A", "B")

CREATE INDEX "_RoomToUser_B_index" ON "public"."_RoomToUser"("B")

ALTER TABLE "public"."Post" ADD FOREIGN KEY ("userId")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Comment" ADD FOREIGN KEY ("userId")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Comment" ADD FOREIGN KEY ("postId")REFERENCES "public"."Post"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."File" ADD FOREIGN KEY ("postId")REFERENCES "public"."Post"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Message" ADD FOREIGN KEY ("fromUserId")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."Message" ADD FOREIGN KEY ("roomId")REFERENCES "public"."Room"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_FollowRelation" ADD FOREIGN KEY ("A")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_FollowRelation" ADD FOREIGN KEY ("B")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_LikeList" ADD FOREIGN KEY ("A")REFERENCES "public"."Post"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_LikeList" ADD FOREIGN KEY ("B")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_RoomToUser" ADD FOREIGN KEY ("A")REFERENCES "public"."Room"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "public"."_RoomToUser" ADD FOREIGN KEY ("B")REFERENCES "public"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200930085445
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,75 @@
+// This is your Prisma schema file,
+// learn more about it in the docs: https://pris.ly/d/prisma-schema
+
+datasource db {
+  provider = "postgresql"
+  url = "***"
+}
+
+generator client {
+  provider = "prisma-client-js"
+}
+
+model User {
+  id             String    @default(cuid()) @id
+  username       String    @unique
+  email          String    @unique
+  firstName      String?   @default("")
+  lastName       String?   @default("")
+  bio            String?   @default("")
+  profileImage   String?   @default("")
+  loginSecret    String?
+  followers      User[]    @relation("FollowRelation")
+  followings     User[]    @relation("FollowRelation")
+  posts          Post[]    @relation("PostList")
+  likes          Post[]    @relation("LikeList")
+  comments       Comment[]
+  participatings Room[]    @relation(references: [id])
+  messages       Message[]
+  signUpAt       DateTime  @default(now())
+}
+
+model Post {
+  id       Int       @default(autoincrement()) @id
+  location String?
+  caption  String?
+  files    File[]
+  likes    User[]    @relation("LikeList")
+  comments Comment[]
+  user     User      @relation("PostList", fields: [userId], references: [id])
+  userId   String
+  postAt   DateTime  @default(now())
+}
+
+model Comment {
+  id        Int      @default(autoincrement()) @id
+  text      String
+  user      User     @relation(fields: [userId], references: [id])
+  userId    String
+  post      Post     @relation(fields: [postId], references: [id])
+  postId    Int
+  commentAt DateTime @default(now())
+}
+
+model File {
+  id     Int    @default(autoincrement()) @id
+  url    String
+  post   Post   @relation(fields: [postId], references: [id])
+  postId Int
+}
+
+model Room {
+  id          Int       @default(autoincrement()) @id
+  participant User[]    @relation(references: [id])
+  messages    Message[]
+}
+
+model Message {
+  id         Int      @default(autoincrement()) @id
+  text       String
+  fromUser   User     @relation(fields: [fromUserId], references: [id])
+  fromUserId String
+  room       Room     @relation(fields: [roomId], references: [id])
+  roomId     Int
+  timeStamp  DateTime @default(now())
+}
```


