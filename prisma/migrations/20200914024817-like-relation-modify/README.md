# Migration `20200914024817-like-relation-modify`

This migration has been generated by kimjeongwonn at 9/14/2020, 2:48:17 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE `prismagram`.`Like` DROP FOREIGN KEY `Like_ibfk_2`

ALTER TABLE `prismagram`.`Like` DROP FOREIGN KEY `Like_ibfk_1`

CREATE TABLE `prismagram`.`_LikeList` (
`A` int  NOT NULL ,
`B` varchar(191)  NOT NULL ,
UNIQUE Index `_LikeList_AB_unique`(`A`,
`B`),
Index `_LikeList_B_index`(`B`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

ALTER TABLE `prismagram`.`_LikeList` ADD FOREIGN KEY (`A`) REFERENCES `prismagram`.`Post`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `prismagram`.`_LikeList` ADD FOREIGN KEY (`B`) REFERENCES `prismagram`.`User`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

DROP TABLE `prismagram`.`Like`
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200911043435..20200914024817-like-relation-modify
--- datamodel.dml
+++ datamodel.dml
@@ -2,9 +2,9 @@
 // learn more about it in the docs: https://pris.ly/d/prisma-schema
 datasource db {
   provider = "mysql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -19,10 +19,10 @@
   bio             String?   @default("")
   loginSecret     String?
   followers       User[]    @relation("FollowRelation", references: [id])
   followings      User[]    @relation("FollowRelation", references: [id])
-  posts           Post[]
-  likes           Like[]
+  posts           Post[]    @relation("PostList")
+  likes           Post[]    @relation("LikeList")
   comments        Comment[]
   rooms           Room[]
   sendMessages    Message[] @relation("ToUser")
   receiveMessages Message[] @relation("FromUser")
@@ -33,23 +33,15 @@
   id       Int       @default(autoincrement()) @id
   location String?
   caption  String?
   files    File[]
-  likes    Like[]
+  likes    User[]    @relation("LikeList")
   comments Comment[]
-  user     User      @relation(fields: [userId], references: [id])
+  user     User      @relation("PostList", fields: [userId], references: [id])
   userId   String
   postAt   DateTime  @default(now())
 }
-model Like {
-  id     Int    @default(autoincrement()) @id
-  user   User   @relation(fields: [userId], references: [id])
-  userId String
-  post   Post   @relation(fields: [postId], references: [id])
-  postId Int
-}
-
 model Comment {
   id        Int      @default(autoincrement()) @id
   text      String
   user      User     @relation(fields: [userId], references: [id])
```


